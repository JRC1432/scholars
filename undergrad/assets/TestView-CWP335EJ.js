import{S as P,a3 as $,aE as ce,aa as re,r as i,J as c,F as J,$ as R,aG as me,o as w,d as ve,w as o,a8 as H,e as l,aH as pe,a9 as q,a as t,c as Q,a4 as n,aI as K,g as p,ag as _e,p as fe,ae as Ve,ab as ge,a7 as u,aJ as W,af as be,l as z}from"./index-Lhrr584p.js";import{Q as X}from"./QSelect-CbOoRKNU.js";import{a as xe,Q as _}from"./QTable-D0_fp5GO.js";import"./QBreadcrumbs-Bw8Un86e.js";import"./sweetalert2.all-Ced_kw8w.js";import"./QMenu-kJOoyUX5.js";import"./selection-Dtef2Nxx.js";import"./QItemLabel-DH87CdX2.js";import"./QList-DakvS0LG.js";import"./QMarkupTable-DNJNZBGt.js";const he=t("div",{class:"q-pa-md q-gutter-sm"},[t("div",{class:"text-bold text-h6 primary-text"},"Edit Grades")],-1),ke={class:"col-12"},ye={class:"q-col-gutter-md row items-start"},we={class:"col-xs-12 col-sm-3 col-md-6"},Ue={key:0,class:"text-h6"},Se={key:1,class:"text-h6"},Ce={key:2,class:"text-h6"},Ee={key:3,class:"text-h6"},Te={class:"text-h6"},qe={class:"text-h6"},Qe=t("span",{class:"text-h6"},"Term Required: ",-1),Fe={class:"q-pa-xs q-gutter-sm"},Ge={class:"col-xs-12 col-sm-3 col-md-6"},Ae={class:"float-right"},Re=t("span",{class:"text-bold primary-text"},"Latest?",-1),Ne={class:"text-h6"},De={class:"text-h6"},Ie={class:"text-h6"},Le={class:"q-gutter-sm row items-start"},Ye=t("div",{class:"col-xs-12 col-sm-6 col-md-4"},[t("div",{class:"text-h6"},"Status (END of Term):")],-1),je={class:"col-xs-12 col-sm-6 col-md-3"},Be={class:"col-xs-12 col-sm-3 col-md-3"},Me={class:"col-12"},Oe={class:"q-col-gutter-md row items-start"},Pe={class:"col-xs-12 col-sm-6 col-md-2"},$e=t("span",{class:"text-bold primary-text"},"SUBJECT CODE:",-1),Je={class:"col-xs-12 col-sm-6 col-md-2"},He=t("span",{class:"text-bold primary-text"},"ACADEMIC:",-1),Ke={class:"col-xs-12 col-sm-6 col-md-2"},We=t("span",{class:"text-bold primary-text"},"UNITS:",-1),ze={class:"col-xs-12 col-sm-6 col-md-2"},Xe=t("span",{class:"text-bold primary-text"},"GRADE:",-1),Ze={class:"col-xs-12 col-sm-6 col-md-2"},ea=t("span",{class:"text-bold primary-text"},"COMPLETION:",-1),aa={class:"col-xs-12 col-sm-6 col-md-2"},la=t("span",{class:"text-bold primary-text"},"REMARKS:",-1),ta={class:"q-pa-md"},oa={class:"col-12"},sa={class:"q-col-gutter-md row items-start"},da={class:"col-xs-12 col-sm-3 col-md-6"},ia={class:"col-xs-12 col-sm-3 col-md-6"},ba={__name:"TestView",setup(na){P("$user"),$(),$();const F=P("$axios"),Z=ce(),U=re({term:"",stat1:"SELECT",stat2:"SELECT"}),g=i(""),S=i(!1),b=i(""),x=i(""),h=i(""),k=i(""),C=i(""),v=i([{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]),ee=i(0),y=i(""),f=i(""),N=i(""),D=i(""),V=i(""),I=i(""),L=i("");i("");const Y=i(""),ae=()=>{g.value&&b.value&&x.value&&h.value&&k.value&&(v.value.push({id:c(),scode:g.value,academic:S.value,units:parseFloat(b.value),grade:parseFloat(x.value),completion:h.value,remarks:k.value}),g.value="",S.value=!1,b.value="",x.value="",h.value="",k.value="")},le=s=>{const a=v.value.findIndex(e=>e.id===s);v.value.splice(a,1)},te=()=>{v.value=[{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]},j=[{name:"scode",label:"Subject Code",field:"scode",align:"left"},{name:"academic",label:"Academic",field:"academic",align:"center"},{name:"units",label:"Units",field:"units",align:"left"},{name:"grade",label:"Grade",field:"grade",align:"left"},{name:"completion",label:"Completion",field:"completion",align:"left"},{name:"remarks",label:"Remarks",field:"remarks",align:"left"},{name:"action",label:"Action",field:"action",align:"center"}],B=J(()=>v.value.filter(s=>s.academic).reduce((s,a)=>s+parseFloat(a.units||0),0).toFixed(2)),M=J(()=>{const s=v.value.filter(d=>d.academic),a=s.reduce((d,r)=>d+parseFloat(r.units||0),0),e=s.reduce((d,r)=>d+parseFloat(r.units||0)*parseFloat(r.grade||0),0);return a>0?(e/a).toFixed(2):"0.00"});var E=[];const G=i(E);R(()=>{oe()});const oe=()=>{F.get("/read.php?readstat2").then(s=>{E=s.data})},se=(s,a)=>{if(s===""){a(()=>{G.value=E});return}a(()=>{const e=s.toLowerCase();G.value=E.filter(d=>d.label.toLowerCase().includes(e))})};var T=[];const A=i(T);R(()=>{de()});const de=()=>{F.get("/read.php?readstat1").then(s=>{T=s.data})},ie=(s,a)=>{if(s===""){a(()=>{A.value=T});return}a(()=>{const e=s.toLowerCase();A.value=T.filter(d=>d.label.toLowerCase().includes(e))})},ne=()=>{const s=j.map(m=>m.label),a=v.value.map(m=>[m.scode,m.academic?"Yes":"No",m.units,m.grade,m.completion,m.remarks]);let e="data:text/csv;charset=utf-8,"+[s.join(","),...a.map(m=>m.join(","))].join(`
`);const d=encodeURI(e),r=document.createElement("a");r.setAttribute("href",d),r.setAttribute("download","grades.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r)},O=i();R(()=>{ue()});const ue=()=>{console.log(C.value+"start"),O.value=Z.params.id;var s=new FormData;s.append("id",O.value),F.post("/read.php?readEditGrades",s).then(a=>{console.log(a.data),y.value=a.data.sy,f.value=a.data.term,N.value=a.data.college_name,D.value=a.data.course_name,V.value=a.data.term_required,I.value=a.data.reg_verified_by,L.value=a.data.grades_verified_by,Y.value=a.data.standing,C.value=a.data.latest_flag==1,me(()=>{V.value=ee.value===1?"YES":"NO"})})};return(s,a)=>(w(),ve(H,{flat:"",class:"my-card surface-container rounded-borders-20"},{default:o(()=>[he,l(q,null,{default:o(()=>[l(pe,{class:"q-pa-md"},{default:o(()=>[l(H,{class:"q-pa-md rounded-borders-20"},{default:o(()=>[l(q,null,{default:o(()=>[t("div",ke,[t("div",ye,[t("div",we,[f.value===1?(w(),Q("div",Ue," SY: "+n(y.value)+", "+n(f.value)+"st Term ",1)):f.value===2?(w(),Q("div",Se," SY: "+n(y.value)+", "+n(f.value)+"nd Term ",1)):f.value===3?(w(),Q("div",Ce," SY: "+n(y.value)+", Summer ",1)):(w(),Q("div",Ee,"SY: "+n(y.value)+", Midyear",1)),t("div",Te,"School: "+n(N.value),1),t("div",qe,"Course: "+n(D.value),1),t("div",null,[Qe,l(K,{modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),val:"YES",label:"YES"},null,8,["modelValue"]),l(K,{modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value=e),val:"NO",label:"NO"},null,8,["modelValue"]),t("div",Fe,[l(p,{color:"positive",label:"Verify Grades",icon:"verified",rounded:""}),l(p,{color:"negative",label:"Disallow Grades",icon:"cancel",rounded:""}),l(p,{color:"warning",label:"Print",icon:"print",rounded:"",onClick:ne})])])]),t("div",Ge,[t("div",Ae,[Re,l(_e,{modelValue:C.value,"onUpdate:modelValue":a[2]||(a[2]=e=>C.value=e)},null,8,["modelValue"])]),t("div",Ne," Registration Form Verified by: "+n(I.value),1),t("div",De," Grades Verified by: "+n(L.value),1),t("div",Ie," Status (Start of Term): "+n()+" - "+n(Y.value),1),t("div",Le,[Ye,t("div",je,[l(X,{modelValue:U.stat1,"onUpdate:modelValue":a[3]||(a[3]=e=>U.stat1=e),name:"stat1",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:A.value,onFilter:ie},null,8,["modelValue","options"])]),t("div",Be,[l(X,{modelValue:U.stat2,"onUpdate:modelValue":a[4]||(a[4]=e=>U.stat2=e),name:"stat2",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:G.value,onFilter:se},null,8,["modelValue","options"])])])])])])]),_:1}),l(fe,{inset:""}),l(q,null,{default:o(()=>[l(Ve,{onSubmit:ge(ae,["prevent"])},{default:o(()=>[t("div",Me,[t("div",Oe,[t("div",Pe,[$e,l(u,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=e=>g.value=e),filled:"",rules:[e=>!!e||"Subject code is required"]},null,8,["modelValue","rules"])]),t("div",Je,[He,l(W,{modelValue:S.value,"onUpdate:modelValue":a[6]||(a[6]=e=>S.value=e),label:"Include in computation?",filled:""},null,8,["modelValue"])]),t("div",Ke,[We,l(u,{modelValue:b.value,"onUpdate:modelValue":a[7]||(a[7]=e=>b.value=e),filled:"",rules:[e=>!!e||"Unit is required"],mask:"##.##"},null,8,["modelValue","rules"])]),t("div",ze,[Xe,l(u,{modelValue:x.value,"onUpdate:modelValue":a[8]||(a[8]=e=>x.value=e),filled:"",rules:[e=>!!e||"Grade is required"],mask:"#.##"},null,8,["modelValue","rules"])]),t("div",Ze,[ea,l(u,{modelValue:h.value,"onUpdate:modelValue":a[9]||(a[9]=e=>h.value=e),filled:"",rules:[e=>!!e||"Completion is required"]},null,8,["modelValue","rules"])]),t("div",aa,[la,l(u,{modelValue:k.value,"onUpdate:modelValue":a[10]||(a[10]=e=>k.value=e),filled:"",rules:[e=>!!e||"Remarks is required"]},null,8,["modelValue","rules"])])])]),l(p,{type:"submit",label:"Add Subject",color:"primary",class:"q-mt-md",rounded:""})]),_:1})]),_:1}),l(q,null,{default:o(()=>[l(xe,{rows:v.value,columns:j,"row-key":"id",flat:"",bordered:"",separator:"cell"},{"body-cell-scode":o(e=>[l(_,{props:e},{default:o(()=>[l(u,{modelValue:e.row.scode,"onUpdate:modelValue":d=>e.row.scode=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-academic":o(e=>[l(_,{props:e},{default:o(()=>[l(W,{modelValue:e.row.academic,"onUpdate:modelValue":d=>e.row.academic=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-units":o(e=>[l(_,{props:e},{default:o(()=>[l(u,{modelValue:e.row.units,"onUpdate:modelValue":d=>e.row.units=d,mask:"##.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-grade":o(e=>[l(_,{props:e},{default:o(()=>[l(u,{modelValue:e.row.grade,"onUpdate:modelValue":d=>e.row.grade=d,mask:"#.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-completion":o(e=>[l(_,{props:e},{default:o(()=>[l(u,{modelValue:e.row.completion,"onUpdate:modelValue":d=>e.row.completion=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-remarks":o(e=>[l(_,{props:e},{default:o(()=>[l(u,{modelValue:e.row.remarks,"onUpdate:modelValue":d=>e.row.remarks=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-action":o(e=>[l(_,{props:e},{default:o(()=>[l(p,{flat:"",icon:"delete",color:"negative",onClick:d=>le(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"]),t("div",ta,[t("div",oa,[t("div",sa,[t("div",da,[l(u,{filled:"",modelValue:B.value,"onUpdate:modelValue":a[11]||(a[11]=e=>B.value=e),label:"Total Units:",readonly:""},null,8,["modelValue"])]),t("div",ia,[l(u,{filled:"",modelValue:M.value,"onUpdate:modelValue":a[12]||(a[12]=e=>M.value=e),label:"General Weighted Average:",readonly:""},null,8,["modelValue"])])])])])]),_:1}),l(be,{align:"around"},{default:o(()=>[l(p,{rounded:"",style:{width:"40%"},color:"primary"},{default:o(()=>[z("SAVE")]),_:1}),l(p,{rounded:"",style:{width:"40%"},color:"warning",onClick:te},{default:o(()=>[z(" RESET ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{ba as default};
