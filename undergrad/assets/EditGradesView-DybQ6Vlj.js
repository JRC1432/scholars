import{S as E,a3 as q,aE as W,aa as ue,r as n,J as r,F as J,$ as ce,aG as me,o as X,d as pe,w as s,e as l,a9 as _,aH as ve,a8 as j,a as t,a4 as c,aI as Y,g as p,ag as fe,p as _e,ae as Ve,ab as be,a7 as i,aJ as z,af as ge,l as C,c as xe,a5 as he,u as K,aF as we}from"./index-Lhrr584p.js";import{_ as ye}from"./ScInfo-LJxXJbwl.js";import{Q as H}from"./QSelect-CbOoRKNU.js";import{a as Ue,Q as v}from"./QTable-D0_fp5GO.js";import"./QBreadcrumbs-Bw8Un86e.js";import"./sweetalert2.all-Ced_kw8w.js";import{I as ke}from"./IconEdit-C3nPk05Z.js";import{I as Se}from"./IconTool-C8NaaGe4.js";import"./QMenu-kJOoyUX5.js";import"./selection-Dtef2Nxx.js";import"./QItemLabel-DH87CdX2.js";import"./QList-DakvS0LG.js";import"./QMarkupTable-DNJNZBGt.js";import"./createVueComponent-CH2njvqE.js";const Ee={class:"col-12"},qe={class:"q-col-gutter-md row items-start"},Ce={class:"col-xs-12 col-sm-3 col-md-6"},Te={class:"text-h6"},Fe={class:"text-h6"},Ge={class:"text-h6"},Qe=t("span",{class:"text-h6"},"Term Required: ",-1),De={class:"q-pa-xs q-gutter-sm"},Re={class:"col-xs-12 col-sm-3 col-md-6"},Ie={class:"float-right"},$e=t("span",{class:"text-bold primary-text"},"Latest?",-1),Ae={class:"text-h6"},Ne={class:"text-h6"},Le={class:"text-h6"},Oe={class:"q-gutter-sm row items-start"},Be=t("div",{class:"col-xs-12 col-sm-6 col-md-4"},[t("div",{class:"text-h6"},"Status (END of Term):")],-1),Pe={class:"col-xs-12 col-sm-6 col-md-3"},Me={class:"col-xs-12 col-sm-3 col-md-3"},je={class:"col-12"},Je={class:"q-col-gutter-md row items-start"},Ye={class:"col-xs-12 col-sm-6 col-md-2"},ze=t("span",{class:"text-bold primary-text"},"SUBJECT CODE:",-1),Ke={class:"col-xs-12 col-sm-6 col-md-2"},He=t("span",{class:"text-bold primary-text"},"ACADEMIC:",-1),We={class:"col-xs-12 col-sm-6 col-md-2"},Xe=t("span",{class:"text-bold primary-text"},"UNITS:",-1),Ze={class:"col-xs-12 col-sm-6 col-md-2"},ea=t("span",{class:"text-bold primary-text"},"GRADE:",-1),aa={class:"col-xs-12 col-sm-6 col-md-2"},la=t("span",{class:"text-bold primary-text"},"COMPLETION:",-1),ta={class:"col-xs-12 col-sm-6 col-md-2"},oa=t("span",{class:"text-bold primary-text"},"REMARKS:",-1),sa={class:"q-pa-md"},da={class:"col-12"},na={class:"q-col-gutter-md row items-start"},ia={class:"col-xs-12 col-sm-3 col-md-6"},ra={class:"col-xs-12 col-sm-3 col-md-6"},ua={__name:"EditGrades",setup(Z){E("$user"),q(),q();const V=E("$axios"),T=W(),f=ue({term:"",stat1:"",stat2:""}),b=n(""),y=n(!1),g=n(""),x=n(""),h=n(""),w=n(""),F=n(""),u=n([{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]),ee=n(0),G=n(""),Q=n(""),D=n(""),R=n(""),m=n(""),I=n(""),$=n(""),A=n(""),N=n(""),ae=()=>{b.value&&g.value&&x.value&&h.value&&w.value&&(u.value.push({id:r(),scode:b.value,academic:y.value,units:parseFloat(g.value),grade:parseFloat(x.value),completion:h.value,remarks:w.value}),b.value="",y.value=!1,g.value="",x.value="",h.value="",w.value="")},le=o=>{const a=u.value.findIndex(e=>e.id===o);u.value.splice(a,1)},te=()=>{u.value=[{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:r(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]},oe=[{name:"scode",label:"Subject Code",field:"scode",align:"left"},{name:"academic",label:"Academic",field:"academic",align:"center"},{name:"units",label:"Units",field:"units",align:"left"},{name:"grade",label:"Grade",field:"grade",align:"left"},{name:"completion",label:"Completion",field:"completion",align:"left"},{name:"remarks",label:"Remarks",field:"remarks",align:"left"},{name:"action",label:"Action",field:"action",align:"center"}],L=J(()=>u.value.filter(o=>o.academic).reduce((o,a)=>o+parseFloat(a.units||0),0).toFixed(3)),O=J(()=>{const o=u.value.filter(d=>d.academic),a=o.reduce((d,S)=>d+parseFloat(S.units||0),0),e=o.reduce((d,S)=>d+parseFloat(S.units||0)*parseFloat(S.grade||0),0);return a>0?(e/a).toFixed(3):"0.000"});var U=[];const B=n(U);var k=[];const P=n(k),M=n();ce(()=>{se()});const se=()=>{M.value=T.params.id;var o=new FormData;o.append("id",M.value),V.post("/read.php?readEditGrades",o).then(a=>{G.value=a.data.sy,Q.value=a.data.sem,D.value=a.data.school,R.value=a.data.course,m.value=a.data.term_required,I.value=a.data.reg_verified_by,$.value=a.data.grades_verified_by,A.value=a.data.pstart,N.value=a.data.sstanding,F.value=a.data.latest_flag==1,me(()=>{m.value=ee.value===1?"YES":"NO"})}),V.get("/read.php?readstat2").then(a=>{U=a.data}),V.get("/read.php?readstat1").then(a=>{k=a.data})},de=(o,a)=>{if(o===""){a(()=>{B.value=U});return}a(()=>{const e=o.toLowerCase();B.value=U.filter(d=>d.label.toLowerCase().includes(e))})},ne=(o,a)=>{if(o===""){a(()=>{P.value=k});return}a(()=>{const e=o.toLowerCase();P.value=k.filter(d=>d.label.toLowerCase().includes(e))})},ie=n(),re=()=>{alert("Please click OK to print PDF"),ie.value=T.params.id;var o=new FormData;o.append("id",M.value),o.append("grades",JSON.stringify(u.value)),o.append("sy",G.value),o.append("sem",Q.value),o.append("school",D.value),o.append("course",R.value),o.append("termreq",m.value),o.append("regVerified",I.value),o.append("gradeVerified",$.value),o.append("statStart",A.value),o.append("statEnd",N.value),o.append("stat1",f.stat1),o.append("stat2",f.stat2),o.append("computedTotalUnits",L.value),o.append("computedGwa",O.value),V.post("/create.php?printGradesPDF",o,{responseType:"blob"}).then(function(a){var e=new Blob([a.data],{type:"application/pdf"}),d=URL.createObjectURL(e);window.open(d)})};return(o,a)=>(X(),pe(j,{flat:"",class:"my-card surface-container rounded-borders-20"},{default:s(()=>[l(_,null,{default:s(()=>[l(ve,{class:"q-pa-md"},{default:s(()=>[l(j,{class:"q-pa-md rounded-borders-20 banner-5"},{default:s(()=>[l(_,null,{default:s(()=>[t("div",Ee,[t("div",qe,[t("div",Ce,[t("div",Te,"SY: "+c(G.value)+", "+c(Q.value),1),t("div",Fe,"School: "+c(D.value),1),t("div",Ge,"Course: "+c(R.value),1),t("div",null,[Qe,l(Y,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),val:"YES",label:"YES"},null,8,["modelValue"]),l(Y,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),val:"NO",label:"NO"},null,8,["modelValue"]),t("div",De,[l(p,{color:"positive",label:"Verify Grades",icon:"verified",rounded:""}),l(p,{color:"negative",label:"Disallow Grades",icon:"cancel",rounded:""}),l(p,{color:"warning",label:"Print",icon:"print",rounded:"",onClick:re})])])]),t("div",Re,[t("div",Ie,[$e,l(fe,{modelValue:F.value,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value=e)},null,8,["modelValue"])]),t("div",Ae," Registration Form Verified by: "+c(I.value),1),t("div",Ne," Grades Verified by: "+c($.value),1),t("div",Le," Status (Start of Term): "+c(A.value)+" - "+c(N.value),1),t("div",Oe,[Be,t("div",Pe,[l(H,{modelValue:f.stat1,"onUpdate:modelValue":a[3]||(a[3]=e=>f.stat1=e),name:"stat1",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:P.value,onFilter:ne,clearable:""},null,8,["modelValue","options"])]),t("div",Me,[l(H,{modelValue:f.stat2,"onUpdate:modelValue":a[4]||(a[4]=e=>f.stat2=e),name:"stat2",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:B.value,onFilter:de,clearable:""},null,8,["modelValue","options"])])])])])])]),_:1}),l(_e,{inset:""}),l(_,null,{default:s(()=>[l(Ve,{onSubmit:be(ae,["prevent"])},{default:s(()=>[t("div",je,[t("div",Je,[t("div",Ye,[ze,l(i,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=e=>b.value=e),filled:"",rules:[e=>!!e||"Subject code is required"]},null,8,["modelValue","rules"])]),t("div",Ke,[He,l(z,{modelValue:y.value,"onUpdate:modelValue":a[6]||(a[6]=e=>y.value=e),label:"Include in computation?",filled:""},null,8,["modelValue"])]),t("div",We,[Xe,l(i,{modelValue:g.value,"onUpdate:modelValue":a[7]||(a[7]=e=>g.value=e),filled:"",rules:[e=>!!e||"Unit is required"],mask:"##.##"},null,8,["modelValue","rules"])]),t("div",Ze,[ea,l(i,{modelValue:x.value,"onUpdate:modelValue":a[8]||(a[8]=e=>x.value=e),filled:"",rules:[e=>!!e||"Grade is required"],mask:"#.##"},null,8,["modelValue","rules"])]),t("div",aa,[la,l(i,{modelValue:h.value,"onUpdate:modelValue":a[9]||(a[9]=e=>h.value=e),filled:"",rules:[e=>!!e||"Completion is required"]},null,8,["modelValue","rules"])]),t("div",ta,[oa,l(i,{modelValue:w.value,"onUpdate:modelValue":a[10]||(a[10]=e=>w.value=e),filled:"",rules:[e=>!!e||"Remarks is required"]},null,8,["modelValue","rules"])])])]),l(p,{type:"submit",label:"Add Subject",color:"primary",class:"q-mt-md",rounded:""})]),_:1})]),_:1}),l(_,null,{default:s(()=>[l(Ue,{rows:u.value,columns:oe,"row-key":"id",flat:"",bordered:"",separator:"cell",class:"banner-5"},{"body-cell-scode":s(e=>[l(v,{props:e},{default:s(()=>[l(i,{modelValue:e.row.scode,"onUpdate:modelValue":d=>e.row.scode=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-academic":s(e=>[l(v,{props:e},{default:s(()=>[l(z,{modelValue:e.row.academic,"onUpdate:modelValue":d=>e.row.academic=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-units":s(e=>[l(v,{props:e},{default:s(()=>[l(i,{modelValue:e.row.units,"onUpdate:modelValue":d=>e.row.units=d,mask:"##.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-grade":s(e=>[l(v,{props:e},{default:s(()=>[l(i,{modelValue:e.row.grade,"onUpdate:modelValue":d=>e.row.grade=d,mask:"#.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-completion":s(e=>[l(v,{props:e},{default:s(()=>[l(i,{modelValue:e.row.completion,"onUpdate:modelValue":d=>e.row.completion=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-remarks":s(e=>[l(v,{props:e},{default:s(()=>[l(i,{modelValue:e.row.remarks,"onUpdate:modelValue":d=>e.row.remarks=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-action":s(e=>[l(v,{props:e},{default:s(()=>[l(p,{flat:"",icon:"delete",color:"negative",onClick:d=>le(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"]),t("div",sa,[t("div",da,[t("div",na,[t("div",ia,[l(i,{filled:"",modelValue:L.value,"onUpdate:modelValue":a[11]||(a[11]=e=>L.value=e),label:"Total Units:",readonly:""},null,8,["modelValue"])]),t("div",ra,[l(i,{filled:"",modelValue:O.value,"onUpdate:modelValue":a[12]||(a[12]=e=>O.value=e),label:"General Weighted Average:",readonly:""},null,8,["modelValue"])])])])])]),_:1}),l(ge,{align:"around"},{default:s(()=>[l(p,{rounded:"",style:{width:"40%"},color:"primary"},{default:s(()=>[C("SAVE")]),_:1}),l(p,{rounded:"",style:{width:"40%"},color:"warning",onClick:te},{default:s(()=>[C(" RESET ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},ca={class:"q-pa-lg"},ma={class:"q-pa-md text-center text-bold primary-text text-h4"},pa={class:"q-pa-md text-center"},va={class:"text-h3"},Ca={__name:"EditGradesView",setup(Z){return E("$user"),q(),q(),E("$axios"),W(),(V,T)=>(X(),xe(he,null,[l(ye),t("div",ca,[l(j,{flat:"",class:"my-card surface-container rounded-borders-20"},{default:s(()=>[t("div",ma,[l(K(Se),{size:30,"stroke-width":"2"}),C(" Monitoring Sheet ")]),l(_,null,{default:s(()=>[t("div",pa,[l(we,{"inline-actions":"",rounded:"",class:"text-bold banner rounded-borders-20"},{default:s(()=>[t("div",va,[l(K(ke),{size:40,"stroke-width":"2"}),C(" EDIT GRADES ")])]),_:1})])]),_:1}),l(_,null,{default:s(()=>[l(ua)]),_:1})]),_:1})])],64))}};export{Ca as default};
