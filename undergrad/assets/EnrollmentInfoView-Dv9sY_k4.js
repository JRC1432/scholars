import{S as O,a3 as B,aE as ae,aa as le,r as d,J as c,F as M,$ as oe,b as te,o as se,c as de,e as l,a as o,w as s,a8 as P,a5 as ne,a9 as g,aF as ie,l as G,aH as re,a4 as x,g as h,ag as ce,p as ue,ae as me,ab as pe,a7 as i,aJ as j,af as ve}from"./index-Lhrr584p.js";import{Q as $}from"./QSelect-CbOoRKNU.js";import{a as _e,Q as m}from"./QTable-D0_fp5GO.js";import{_ as fe}from"./ScInfo-LJxXJbwl.js";import"./sweetalert2.all-Ced_kw8w.js";import"./QMenu-kJOoyUX5.js";import"./selection-Dtef2Nxx.js";import"./QItemLabel-DH87CdX2.js";import"./QList-DakvS0LG.js";import"./QMarkupTable-DNJNZBGt.js";import"./QBreadcrumbs-Bw8Un86e.js";const Ve={class:"q-pa-lg"},be={class:"q-pa-md text-center"},ge={class:"text-h3"},xe={class:"col-12"},he={class:"q-col-gutter-md row items-start"},we={class:"col-xs-12 col-sm-3 col-md-6"},Ue={class:"text-h6"},ye={class:"text-h6"},ke={class:"text-h6"},Ce={class:"q-pa-xs q-gutter-sm"},Se={class:"col-xs-12 col-sm-3 col-md-6"},Te={class:"float-right"},Fe=o("span",{class:"text-bold primary-text"},"Latest?",-1),qe={class:"text-h6"},Ee={class:"text-h6"},Qe={class:"q-gutter-sm row items-start"},Re=o("div",{class:"col-xs-12 col-sm-6 col-md-4"},[o("div",{class:"text-h6"},"Status (Start of Sem):")],-1),Ae={class:"col-xs-12 col-sm-6 col-md-3"},De={class:"col-xs-12 col-sm-3 col-md-3"},Ge={class:"col-12"},Ie={class:"q-col-gutter-md row items-start"},Le={class:"col-xs-12 col-sm-6 col-md-2"},Ne=o("span",{class:"text-bold primary-text"},"SUBJECT CODE:",-1),Oe={class:"col-xs-12 col-sm-6 col-md-2"},Be=o("span",{class:"text-bold primary-text"},"ACADEMIC:",-1),Me={class:"col-xs-12 col-sm-6 col-md-2"},Pe=o("span",{class:"text-bold primary-text"},"UNITS:",-1),je={class:"col-xs-12 col-sm-6 col-md-2"},$e=o("span",{class:"text-bold primary-text"},"GRADE:",-1),Je={class:"col-xs-12 col-sm-6 col-md-2"},Ke=o("span",{class:"text-bold primary-text"},"COMPLETION:",-1),ze={class:"col-xs-12 col-sm-6 col-md-2"},He=o("span",{class:"text-bold primary-text"},"REMARKS:",-1),We={class:"q-pa-md"},Ye={class:"col-12"},Xe={class:"q-col-gutter-md row items-start"},Ze={class:"col-xs-12 col-sm-3 col-md-6"},ea={class:"col-xs-12 col-sm-3 col-md-6"},pa={__name:"EnrollmentInfoView",setup(aa){O("$user"),B(),B();const w=O("$axios"),I=ae(),p=le({term:"",stat1:"",stat2:""}),v=d(""),U=d(!1),_=d(""),f=d(""),V=d(""),b=d(""),S=d(""),u=d([{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]);d(0);const T=d(""),y=d(""),F=d(""),q=d(""),L=d(""),N=d(""),J=()=>{v.value&&_.value&&f.value&&V.value&&b.value&&(u.value.push({id:c(),scode:v.value,academic:U.value,units:parseFloat(_.value),grade:parseFloat(f.value),completion:V.value,remarks:b.value}),v.value="",U.value=!1,_.value="",f.value="",V.value="",b.value="")},K=t=>{const a=u.value.findIndex(r=>r.id===t);u.value.splice(a,1)},z=()=>{u.value=[{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""},{id:c(),scode:"",academic:!1,units:"",grade:"",completion:"",remarks:""}]},H=[{name:"scode",label:"Subject Code",field:"scode",align:"left"},{name:"academic",label:"Academic",field:"academic",align:"center"},{name:"units",label:"Units",field:"units",align:"left"},{name:"grade",label:"Grade",field:"grade",align:"left"},{name:"completion",label:"Completion",field:"completion",align:"left"},{name:"remarks",label:"Remarks",field:"remarks",align:"left"},{name:"action",label:"Action",field:"action",align:"center"}],E=M(()=>u.value.filter(t=>t.academic).reduce((t,a)=>t+parseFloat(a.units||0),0).toFixed(3)),Q=M(()=>{const t=u.value.filter(e=>e.academic),a=t.reduce((e,n)=>e+parseFloat(n.units||0),0),r=t.reduce((e,n)=>e+parseFloat(n.units||0)*parseFloat(n.grade||0),0);return a>0?(r/a).toFixed(3):"0.000"});var k=[];const R=d(k);var C=[];const A=d(C),D=d();oe(()=>{W()});const W=()=>{D.value=I.params.id;var t=new FormData;t.append("id",D.value),w.post("/read.php?readEditGrades",t).then(a=>{T.value=a.data.sy,y.value=a.data.sem,F.value=a.data.school,q.value=a.data.course,L.value=a.data.reg_verified_by,N.value=a.data.grades_verified_by,S.value=a.data.latest_flag==1}),w.get("/read.php?readstat2").then(a=>{k=a.data}),w.get("/read.php?readstat1").then(a=>{C=a.data})},Y=(t,a)=>{if(t===""){a(()=>{R.value=k});return}a(()=>{const r=t.toLowerCase();R.value=k.filter(e=>e.label.toLowerCase().includes(r))})},X=(t,a)=>{if(t===""){a(()=>{A.value=C});return}a(()=>{const r=t.toLowerCase();A.value=C.filter(e=>e.label.toLowerCase().includes(r))})},Z=d(),ee=()=>{alert("Please click OK to print PDF"),Z.value=I.params.id;var t=new FormData;t.append("id",D.value),t.append("grades",JSON.stringify(u.value)),t.append("sy",T.value),t.append("sem",y.value),t.append("school",F.value),t.append("course",q.value),t.append("regVerified",L.value),t.append("gradeVerified",N.value),t.append("stat1",p.stat1),t.append("stat2",p.stat2),t.append("computedTotalUnits",E.value),t.append("computedGwa",Q.value),w.post("/create.php?printGradesPDF",t,{responseType:"blob"}).then(function(a){var r=new Blob([a.data],{type:"application/pdf"}),e=URL.createObjectURL(r);window.open(e)})};return(t,a)=>{const r=te("IconEdit");return se(),de(ne,null,[l(fe),o("div",Ve,[l(P,{flat:"",class:"my-card surface-container rounded-borders-20"},{default:s(()=>[l(g,null,{default:s(()=>[o("div",be,[l(ie,{"inline-actions":"",rounded:"",class:"text-bold banner rounded-borders-20"},{default:s(()=>[o("div",ge,[l(r,{size:40,"stroke-width":"2"}),G(" ADD ENROLLMENT INFORMATION ")])]),_:1})])]),_:1}),l(g,null,{default:s(()=>[l(re,{class:"q-pa-md"},{default:s(()=>[l(P,{class:"q-pa-md rounded-borders-20 banner-5"},{default:s(()=>[l(g,null,{default:s(()=>[o("div",xe,[o("div",he,[o("div",we,[o("div",Ue,"SY: "+x(T.value),1),o("div",ye,"Term: "+x(y.value),1),o("div",ke,"Term Required: "+x(y.value),1),o("div",null,[o("div",Ce,[l(h,{color:"warning",label:"Print",icon:"print",rounded:"",onClick:ee})])])]),o("div",Se,[o("div",Te,[Fe,l(ce,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e)},null,8,["modelValue"])]),o("div",qe,"School: "+x(F.value),1),o("div",Ee,"Course: "+x(q.value),1),o("div",Qe,[Re,o("div",Ae,[l($,{modelValue:p.stat1,"onUpdate:modelValue":a[1]||(a[1]=e=>p.stat1=e),name:"stat1",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:A.value,onFilter:X,clearable:""},null,8,["modelValue","options"])]),o("div",De,[l($,{modelValue:p.stat2,"onUpdate:modelValue":a[2]||(a[2]=e=>p.stat2=e),name:"stat2",outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"","use-input":"","input-debounce":"0",options:R.value,onFilter:Y,clearable:""},null,8,["modelValue","options"])])])])])])]),_:1}),l(ue,{inset:""}),l(g,null,{default:s(()=>[l(me,{onSubmit:pe(J,["prevent"])},{default:s(()=>[o("div",Ge,[o("div",Ie,[o("div",Le,[Ne,l(i,{modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value=e),filled:"",rules:[e=>!!e||"Subject code is required"]},null,8,["modelValue","rules"])]),o("div",Oe,[Be,l(j,{modelValue:U.value,"onUpdate:modelValue":a[4]||(a[4]=e=>U.value=e),label:"Include in computation?",filled:""},null,8,["modelValue"])]),o("div",Me,[Pe,l(i,{modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=e=>_.value=e),filled:"",rules:[e=>!!e||"Unit is required"],mask:"##.##"},null,8,["modelValue","rules"])]),o("div",je,[$e,l(i,{modelValue:f.value,"onUpdate:modelValue":a[6]||(a[6]=e=>f.value=e),filled:"",rules:[e=>!!e||"Grade is required"],mask:"#.##"},null,8,["modelValue","rules"])]),o("div",Je,[Ke,l(i,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=e=>V.value=e),filled:"",rules:[e=>!!e||"Completion is required"]},null,8,["modelValue","rules"])]),o("div",ze,[He,l(i,{modelValue:b.value,"onUpdate:modelValue":a[8]||(a[8]=e=>b.value=e),filled:"",rules:[e=>!!e||"Remarks is required"]},null,8,["modelValue","rules"])])])]),l(h,{type:"submit",label:"Add Subject",color:"primary",class:"q-mt-md",rounded:""})]),_:1})]),_:1}),l(g,null,{default:s(()=>[l(_e,{rows:u.value,columns:H,"row-key":"id",flat:"",bordered:"",separator:"cell",class:"banner-5"},{"body-cell-scode":s(e=>[l(m,{props:e},{default:s(()=>[l(i,{modelValue:e.row.scode,"onUpdate:modelValue":n=>e.row.scode=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-academic":s(e=>[l(m,{props:e},{default:s(()=>[l(j,{modelValue:e.row.academic,"onUpdate:modelValue":n=>e.row.academic=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-units":s(e=>[l(m,{props:e},{default:s(()=>[l(i,{modelValue:e.row.units,"onUpdate:modelValue":n=>e.row.units=n,mask:"##.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-grade":s(e=>[l(m,{props:e},{default:s(()=>[l(i,{modelValue:e.row.grade,"onUpdate:modelValue":n=>e.row.grade=n,mask:"#.##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-completion":s(e=>[l(m,{props:e},{default:s(()=>[l(i,{modelValue:e.row.completion,"onUpdate:modelValue":n=>e.row.completion=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-remarks":s(e=>[l(m,{props:e},{default:s(()=>[l(i,{modelValue:e.row.remarks,"onUpdate:modelValue":n=>e.row.remarks=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-action":s(e=>[l(m,{props:e},{default:s(()=>[l(h,{flat:"",icon:"delete",color:"negative",onClick:n=>K(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"]),o("div",We,[o("div",Ye,[o("div",Xe,[o("div",Ze,[l(i,{filled:"",modelValue:E.value,"onUpdate:modelValue":a[9]||(a[9]=e=>E.value=e),label:"Total Units:",readonly:""},null,8,["modelValue"])]),o("div",ea,[l(i,{filled:"",modelValue:Q.value,"onUpdate:modelValue":a[10]||(a[10]=e=>Q.value=e),label:"General Weighted Average:",readonly:""},null,8,["modelValue"])])])])])]),_:1}),l(ve,{align:"around"},{default:s(()=>[l(h,{rounded:"",style:{width:"40%"},color:"primary"},{default:s(()=>[G("SAVE")]),_:1}),l(h,{rounded:"",style:{width:"40%"},color:"warning",onClick:z},{default:s(()=>[G(" RESET ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])],64)}}};export{pa as default};
